2018-11-09 14:57:57,866 INFO Initialized rank 0 out of 1
2018-11-09 14:57:57,868 INFO Job configuration: {'description': 'CNN CIFAR10', 'output_dir': '$SCRATCH/sc18-dl-tutorial/cifar-cnn-N${SLURM_JOB_NUM_NODES}-${SLURM_JOB_ID}', 'data': {'name': 'cifar10'}, 'model': {'name': 'cnn', 'input_shape': [32, 32, 3], 'n_classes': 10, 'dropout': 0.1}, 'optimizer': {'name': 'Adam', 'lr': 0.001}, 'training': {'batch_size': 128, 'n_epochs': 16, 'lr_warmup_epochs': 0, 'loss': 'categorical_crossentropy', 'metrics': ['accuracy']}}
2018-11-09 14:57:57,869 INFO Saving job outputs to /global/cscratch1/sd/sfarrell/sc18-dl-tutorial/cifar-cnn-N1-16277619
2018-11-09 14:57:57.874844: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
OMP: Warning #181: OMP_PROC_BIND: ignored because KMP_AFFINITY has been defined
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_1 (Conv2D)            (None, 32, 32, 16)        448       
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 16, 16, 16)        0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 16, 16, 16)        0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 16, 16, 32)        4640      
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 8, 8, 32)          0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 8, 8, 32)          0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 8, 8, 64)          18496     
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 4, 4, 64)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 4, 64)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 1024)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 128)               131200    
_________________________________________________________________
dropout_4 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 10)                1290      
=================================================================
Total params: 156,074
Trainable params: 156,074
Non-trainable params: 0
_________________________________________________________________
Epoch 1/16
 - 87s - loss: 1.7761 - acc: 0.3480 - val_loss: 1.4954 - val_acc: 0.4629
Epoch 2/16
 - 77s - loss: 1.4617 - acc: 0.4743 - val_loss: 1.3636 - val_acc: 0.5093
Epoch 3/16
 - 76s - loss: 1.3412 - acc: 0.5182 - val_loss: 1.1727 - val_acc: 0.5795
Epoch 4/16
 - 77s - loss: 1.2524 - acc: 0.5496 - val_loss: 1.0728 - val_acc: 0.6202
Epoch 5/16
 - 76s - loss: 1.1957 - acc: 0.5727 - val_loss: 1.0223 - val_acc: 0.6372
Epoch 6/16
 - 77s - loss: 1.1406 - acc: 0.5943 - val_loss: 0.9826 - val_acc: 0.6502
Epoch 7/16
 - 76s - loss: 1.1023 - acc: 0.6059 - val_loss: 0.9400 - val_acc: 0.6666
Epoch 8/16
 - 77s - loss: 1.0639 - acc: 0.6222 - val_loss: 0.9227 - val_acc: 0.6722
Epoch 9/16
 - 77s - loss: 1.0322 - acc: 0.6365 - val_loss: 0.9038 - val_acc: 0.6819
Epoch 10/16
 - 77s - loss: 1.0104 - acc: 0.6428 - val_loss: 0.9082 - val_acc: 0.6773
Epoch 11/16
 - 77s - loss: 0.9827 - acc: 0.6516 - val_loss: 0.8958 - val_acc: 0.6874
Epoch 12/16
 - 77s - loss: 0.9584 - acc: 0.6604 - val_loss: 0.8575 - val_acc: 0.6953
Epoch 13/16
 - 77s - loss: 0.9446 - acc: 0.6651 - val_loss: 0.8269 - val_acc: 0.7098
Epoch 14/16
 - 77s - loss: 0.9245 - acc: 0.6715 - val_loss: 0.7766 - val_acc: 0.7295
Epoch 15/16
 - 77s - loss: 0.9061 - acc: 0.6822 - val_loss: 0.7782 - val_acc: 0.7230
Epoch 16/16
 - 77s - loss: 0.8941 - acc: 0.6854 - val_loss: 0.7999 - val_acc: 0.7202
2018-11-09 15:20:24,683 INFO Best validation accuracy: 0.730
2018-11-09 15:20:24,687 INFO Average time per epoch: 83.587 s
2018-11-09 15:20:24,743 INFO All done!
Using TensorFlow backend.
